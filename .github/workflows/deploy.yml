#publish your docker image to github container
name: Docker CI/CD pipeline
on: push

env: 
    REGISTRY: ghcr.io
    IMAGE_NAME: ${{ github.repository }}

jobs:
    build-and-push-image:
        runs-on: alpine-3.14
        permissions:
            contents: read
            packages: write

        steps:
          - uses: actions/checkout@v2
          - name: Login to GitHub Container Registry
            uses: docker/login-action@v1
            with:
              registry: ghcr.io
              username: ${{ github.actor }}
              password: ${{ secrets.GITHUB_TOKEN }}
          - name: Build and push docker image
            run: |
              docker build . --tag ghcr.io/Conventionalwriting/hello-docker:latest
              docker run ghcr.io/Conventionalwriting/hello-docker:latest
              docker push ghcr.io/Conventionalwriting/hello-docker:latest       